fastlane_version "1.61.0"

default_platform :ios

platform :ios do
  before_all do
    ENV["FASTLANE_XCODE_LIST_TIMEOUT"] = '120'
    ENV["DELIVER_ITMSTRANSPORTER_ADDITIONAL_UPLOAD_PARAMETERS"] = "-t DAV"
  end

  desc "Submit a new Beta Build to Apple TestFlight"
  lane :beta do
    increment_version_number(version_number: '0.0.2')
    increment_build_number(build_number: ENV["BUILD_NUMBER"].to_s + '.0')
    ENV["APP_IDENTIFIER"] = "com.turner.cardwars2"
    update_info_plist(plist_path: "./Info.plist", app_identifier: ENV["APP_IDENTIFIER"])
    #sigh(skip_fetch_profiles: true)
    gym
    #pilot(skip_submission: true)
  end

  after_all do |lane|
    # This block is called, only if the executed lane was successful

    # slack(
    #   message: "Successfully deployed new App Update."
    # )
  end

  error do |lane, exception|
    # slack(
    #   message: exception.message,
    #   success: false
    # )
  end
end
